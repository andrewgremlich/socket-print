<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Provel Print</title>
  <meta
    description="A CAD-type application that facilitates a faster turnaround time for amputees to receive 3D printed socket for a residual limb." />
  <link rel="icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180" />
  <link rel="mask-icon" href="/mask-icon.svg" color="#00e1ee" />
  <meta name="theme-color" content="#00e1ee" />

  <script>
    !function (t, e) { var o, n, p, r; e.__SV || (window.posthog = e, e._i = [], e.init = function (i, s, a) { function g(t, e) { var o = e.split("."); 2 == o.length && (t = t[o[0]], e = o[1]), t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } } (p = t.createElement("script")).type = "text/javascript", p.crossOrigin = "anonymous", p.async = !0, p.src = s.api_host.replace(".i.posthog.com", "-assets.i.posthog.com") + "/static/array.js", (r = t.getElementsByTagName("script")[0]).parentNode.insertBefore(p, r); var u = e; for (void 0 !== a ? u = e[a] = [] : a = "posthog", u.people = u.people || [], u.toString = function (t) { var e = "posthog"; return "posthog" !== a && (e += "." + a), t || (e += " (stub)"), e }, u.people.toString = function () { return u.toString(1) + ".people (stub)" }, o = "init Ie Ts Ms Ee Es Rs capture Ge calculateEventProperties Os register register_once register_for_session unregister unregister_for_session js getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty Ds Fs createPersonProfile Ls Ps opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Cs debug I As getPageViewId captureTraceFeedback captureTraceMetric".split(" "), n = 0; n < o.length; n++)g(u, o[n]); e._i.push([i, s, a]) }, e.__SV = 1) }(document, window.posthog || []);
    posthog.init('phc_isO2RdyoBTewhlJ59BlkqYrhzSo3ZyJ1rFUki0K9M4A', {
      api_host: 'https://us.i.posthog.com',
      defaults: '2025-05-24',
      person_profiles: 'identified_only', // or 'always' to create profiles for anonymous users as well
    })
  </script>
</head>

<body>
  <div id="app">
    <div id="menuBar">
      <div>
        <nav role="menubar">
          <h1><a href="/">ProvelPrint</a></h1>

          <div class="menuBarButtonContainer">
            <button role="menuitem" aria-haspopup="true" class="menuBarButton">File</button>

            <div class="menuBarDropdown" role="menu">
              <label style="display: block" class="menuBarDropdownButton fileInputLabel" for="stlFileInput"
                id="stlFileInputLabel">
                Open STL file
                <input role="menuitem" type="file" accept=".stl" id="stlFileInput" name="stlFileInput"
                  class="fileInput" />
              </label>

              <button role="menuitem" class="menuBarDropdownButton" id="restoreDefaultsButton" type="button">Restore
                Defaults</button>

              <button role="menuitem" class="menuBarDropdownButton" id="clearModelButton" type="button">Clear
                model</button>

              <button role="menuitem" class="menuBarDropdownButton" id="addTestStlButton" type="button">Load Test
                STL</button>

              <a role="menuitem" download href="/test_cylinder.gcode" class="menuBarDropdownButton">Get Test Cylinder
                GCode</a>
            </div>
          </div>

          <div class="menuBarButtonContainer">
            <button role="menuitem" aria-haspopup="true" class="menuBarButton">Edit</button>

            <div class="menuBarDropdown" role="menu">
              <button role="menuitem" class="menuBarDropdownButton" id="addMaterialProfile" type="button">Add Material
                Profile</button>
              <button role="menuitem" class="menuBarDropdownButton" id="editActiveMaterialProfile" type="button">Edit
                Active Material
                Profile</button>
              <button role="menuitem" class="menuBarDropdownButton" id="deleteMaterialProfile" type="button">Delete
                Active Material
                Profile</button>
            </div>
          </div>

          <a role="menuitem" class="menuBarButton noDropdown" href="/help.html">Help</a>

          <button role="menuitem" aria-haspopup="true" id="activateInfoDialog" class="menuBarButton noDropdown"
            type="button">Info</button>
        </nav>

        <div id="printActions">
          <button type="button" id="generateGCodeButton">File</button>

          <button type="button" id="printerFileInput" name="printerFileInput">Print</button>
        </div>
      </div>
    </div>

    <main>
      <div id="userInterface">
        <form id="appForm" aria-labelledby="appFormTitle">
          <h2 id="appFormTitle" class="hide">Socket Print Settings</h2>
          <div class="form-group">
            <label for="ipAddressInput">IP Address and Port</label>
            <div id="ipAddress">
              <input style="padding-left: 5px; margin-right: 5px" type="text" id="ipAddressInput" name="ipAddress"
                value="" placeholder="192.168.X.XXX:xxxx" aria-required="true" aria-label="IP Address and Port" />
            </div>
          </div>

          <div aria-describedby="portStatusIcons">
            <span>Port Status</span>
            <div id="portStatusIcons" aria-live="polite">
              <p id="ipAddressSuccess" class="hide">Connected</p>
              <p id="ipAddressFailure">Disconnected</p>
            </div>
          </div>

          <div class="form-group">
            <label for="lockPosition">Lock Position</label>
            <select name="lockPosition" id="lockPosition" aria-label="Lock Position">
              <option value="left" selected>Left</option>
              <option value="right">Right</option>
            </select>
          </div>

          <div class="form-group">
            <label for="cupSize">Cup Size</label>
            <select name="cupSize" id="cupSize" aria-label="Cup Size">
              <option value="84x38" selected>84 x 38</option>
              <option value="84x25">84 x 25</option>
            </select>
          </div>

          <div class="form-group">
            <label for="nozzleSize">Nozzle Size</label>
            <select name="nozzleSize" id="nozzleSize" aria-label="Nozzle Size">
              <option value="3">3mm</option>
              <option value="4">4mm</option>
              <option value="5" selected>5mm</option>
              <option value="6">6mm</option>
              <option value="7">7mm</option>
            </select>
          </div>

          <div class="form-group">
            <label for="layerHeight">Layer Height</label>
            <select name="layerHeight" id="layerHeight" aria-label="Layer Height">
              <option value="0.5">0.5mm</option>
              <option value="1" selected>1mm</option>
              <option value="1.5">1.5mm</option>
              <option value="2">2mm</option>
            </select>
          </div>

          <div class="form-group">
            <label for="activeMaterialProfile">Material</label>
            <select name="activeMaterialProfile" id="activeMaterialProfile" aria-label="Material"></select>
          </div>

          <div>
            <span>Nozzle Temp (C): </span><span id="nozzleTempDisplay">200</span>
          </div>

          <div>
            <span>Cup Temp (C): </span><span id="cupTempDisplay">130</span>
          </div>

          <div>
            <span>Shrink Factor (%): </span><span id="shrinkFactorDisplay">2.6</span>
          </div>

          <div>
            <span>Output Factor: </span><span id="outputFactorDisplay">1</span>
          </div>

          <div>
            <span>Seconds Per Layer: </span><span id="secondsPerLayerDisplay">1</span>
          </div>
        </form>
      </div>

      <div id="secondaryInterface">
        <div id="provelPrint" aria-label="3D Print Preview Area">
          <span id="activeFileName">No file selected</span>
          <div id="estimatedPrintTimeContainer" aria-label="Estimated Print Time">
            <span>Estimated Print Time:</span>
            <span id="estimatedPrintTime">0m 0s</span>
          </div>
          <canvas id="3dViewer"></canvas>
        </div>

        <div id="editSocket" aria-label="Socket Edit Controls">
          <div id="rotateSocket">
            <span>Rotate 90</span>
            <button disabled id="coronalRotater" type="button">Coronal</button>
            <button disabled id="sagittalRotate" type="button">Sagittal</button>
            <button disabled id="transversalRotater" type="button">Transverse</button>
          </div>
          <div id="changePosition">
            <span>Translate</span>
            <label for="horizontalTranslate">X
              <input disabled id="horizontalTranslate" type="number" value="0" step="1" min="-100" max="100" />
            </label>
            <label for="depthTranslate">Y
              <input disabled id="depthTranslate" type="number" value="0" step="1" min="-100" max="100" />
            </label>
            <label for="verticalTranslate">Z
              <input disabled id="verticalTranslate" type="number" value="0" step="1" min="-100" max="100" />
            </label>
          </div>
        </div>
      </div>
    </main>
  </div>

  <material-profile-form></material-profile-form>

  <app-info></app-info>

  <div id="progressBarDiv" aria-live="polite" aria-label="Progress Bar">
    <icon-element type="loader"></icon-element>
    <label for="progressBar" id="progressBarLabel">0%</label>
    <progress id="progressBar" value="0" max="100"></progress>
  </div>

  <div id="loading" aria-live="assertive" aria-label="Loading Spinner">
    <icon-element type="loader"></icon-element>
  </div>

  <script type="module" src="./src/renderer.ts"></script>

  <script>
    console.log();

    if ('serviceWorker' in navigator && location.protocol === 'https:') {
      navigator.serviceWorker.register('/sw.js')
    }
  </script>
</body>

</html>